import java.nio.file.Files

/*
 * This file was generated by the Gradle 'init' task.
 */

plugins {
    id 'java'
    id 'maven-publish'
    id 'application'
}

repositories {
    mavenLocal()
    mavenCentral()
    /*maven {
        url = 'http://repo.maven.apache.org/maven2'
    }*/
}

dependencies {
    implementation 'com.sun.mail:javax.mail:1.6.2'
    implementation 'javax.activation:activation:1.1.1'

}

/*group = 'groupId'
version = '1.0-SNAPSHOT'
description = 'controlTask'
sourceCompatibility = '7'*/

/*publishing {
    publications {
        maven(MavenPublication) {
            from(components.java)
        }
    }
}*/

application {
    mainClassName = 'ru.clevertec.Main'
}

jar {
    manifest {
        attributes 'Main-Class': 'ru.clevertec.Main'
    }
}

/*
task filePng{
    URL url = null;
    try {
        delete("/src/main/java/ru/clevertec/picture/file.png")
        url = new URL("https://github.com/yury-1980/hello-world/raw/main/file.png");
        InputStream inputStream = url.openStream();
        String file = new File("").getAbsolutePath()
        Files.copy(inputStream, new File(file + "/src/main/java/ru/clevertec/picture/file.png").toPath());
    } catch (MalformedURLException e) {
        e.printStackTrace();
    } catch (IOException e) {
        println("File Already Exists")
    }
}*/

class CustomTask extends DefaultTask {

    @Input
    String sourceUrl

    @OutputFile
    File target

    @TaskAction
    void download() {
        try {
            ant.get(src: sourceUrl, dest: target)
        }
        catch (Exception e) {
            println(e)
        }
    }

}
task downloadCheckImage(type: CustomTask){
    sourceUrl = 'https://github.com/yury-1980/hello-world/raw/main/file.png'
    target = new File('src/main/resources/file.png')
}
